<!DOCTYPE html>
<html>
    <head>
        <title>Пример отчета по лабораторной работе.</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
    </head>

    <body>
        <h1>Лабораторная работа № 5</h1>
        <h3>Иванов Иван Иванович, группа 2-1</h3>
        <h3>Вариант № 2-а</h3>
        
        <h2>Исследование непараметрических алгоритмов оценивания плотности распределения 
            случайной величины</h3>
        
        <h3>Цель работы</h3>
        <p>Исследовать алгоритмы оценивания плотности распределения случайных величин 
            и случайных векторов на основе методов Парзена и k ближайших соседей.</p>
        
        <h3>Задание</h3>
        <ol>
            <li>Вычислить абсолютную ошибку оценивания плотности распределения случайной 
                величины при использовании оценки Парзена. Построить график зависимости 
                ошибки оценивания от величины параметра оконной функции следующего вида:

                <ul>
                    <li>гауссовская функция;</li>
                    <li>показательная функция;</li>
                    <li>оконная прямоугольная функция;</li>
                    <li>оконная треугольная функция.</li>
                </ul>
            </li>

            <li>Вычислить среднеквадратичную ошибку оценивания плотности распределения 
                случайной величины по методу Парзена для окна вида:

                <ul>
                    <li><img src="formula1.png" alt="тут должна быть формула((("></li>
                    <li><img src="formula2.png" alt="тут должна быть формула((("></li>
                </ul>
            </li>


            <li>Окно какого вида будет обеспечивать оптимальное по критерию 
                среднеквадратичной ошибки оценивание плотности распределения случайной 
                величины в соответствии с методом Парзена? Построить графики зависимостей 
                ошибок от объема обучающей выборки. Сравните следующие виды окон:

                <ul>
                    <li>гауссовская функция, показательная функция и оконная 
                        прямоугольная функция;</li>
                    <li>гауссовская функция, оконная прямоугольная функция 
                        и оконная треугольная функция.</li>
                </ul>
            </li>
            
            <li>Вычислить абсолютную ошибку оценивания плотности распределения 
                случайного вектора в двумерном пространстве признаков при использовании 
                оценки Парзена. Построить график зависимости ошибки оценивания от 
                величины параметра оконной функции. Используйте одну из следующих оконных 
                функций:

                <ul>
                    <li>гауссовская функция c использованием диагональной матрицы;</li>
                    <li>гауссовская функция c использованием матрицы ковариаций;</li>
                    <li>показательная функция;</li>
                    <li>оконная прямоугольная функция;</li>
                    <li>оконная треугольная функция.</li>
                </ul>
            </li>

            <li>Окно какого вида будет обеспечивать оптимальное по критерию 
                среднеквадратичной ошибки оценивание плотности распределения двумерного 
                случайного вектора по методу Парзена? Построить графики зависимостей 
                ошибок от объема обучающей выборки. Сравните следующие виды окон:

                <ul>
                    <li>гауссовская функция c использованием диагональной матрицы и 
                        гауссовская функция c использованием матрицы ковариаций;</li>
                    <li>гауссовская функция c использованием диагональной матрицы, 
                        показательная функция и оконная треугольная функция;</li>
                    <li>гауссовская функция c использованием матрицы ковариаций, оконная 
                        прямоугольная функция и оконная треугольная функция.</li>
                </ul>
            </li>

            <li>
                Получить оценки плотности распределения случайной величины на основе 
                метода k ближайших соседей. Определить значение параметра k, при котором 
                достигается минимум среднеквадратичной ошибки оценивания.
            </li>

            <li>
                Реализовать оценку плотности распределения двумерного случайного вектора, 
                плотность которого задается на основе пяти гауссовых функций. Определить 
                оптимальное по критерию среднеквадратичной ошибки оценивания значение 
                параметра k.
            </li>
        </ol>
            
        <h3>Код программы (внесённые изменения в шаблон кода выделены)</h3>
        <pre code>
            %%% Оценка плотности распределения вероятностей методом Парзена
            clear all; close all;
            %1.Генерация обучающей выборки и оценка плотности для одномерного случая
            n=1;        %размерность вектора наблюдений
            N=1000;     %объем обучающей выборки
            K=20;       %число шагов по значению параметра оконной функции
            H=100;      %число реализаций эксперимента
            rs=0:1/(K-1):1;
            hNs=N.^-rs;
            err=zeros(1,K);
            x=-3:0.05:3;        %область значений СВ для визуализации
            mx=length(x);       %число точек, для которых проводится оценка
            p=zeros(1,mx);      %плотность распределения СВ 
            p(x>0)=exp(-x(x>0));%вид оцениваемой плотности (показательная)
            %2.Вычислительный эксперимент
            for t=1:H
                for k=1:K
                    h_N=hNs(k);         %параметр оконной функции
                    %Генерация обучающей выборки
                    XN=-log(rand(1,N)); %показательное распределение (b=1);
                    %Вычисление значений функций ядра
                    fit=zeros(N,mx); 
                    for i=1:N,
                        p_k=zeros(n,mx);
                        mx_i=repmat(XN(:,i),[1,mx]);
                        ro=1+((x-mx_i)/h_N).^2; 
                        fit(i,:)=prod(1./(ro*pi*h_N),1);
                    end;%i=1:N
                    %Вычисление оценки плотности распределения вероятностей
                    if N>1
                        p_=sum(fit)/N;
                    else
                        p_=fit;
                    end;
                    %Вычисление среднеквадратичной ошибки оценивания
                    err(k)=err(k)+sqrt(sum((p-p_).^2)./N)./H;
                end;%k=1:K
            end;%t=1:H
            %3.Визуализация зависимости ошибки от значения параметра h_N
            figure; grid on;
            plot(hNs,err);
            title('Среднеквадратичная ошибка оценивания','FontName','Courier','FontSize',14);
            xlabel('h_N','FontName','Courier'); ylabel('mse','FontName','Courier');
            figure; grid on;
            plot(rs,err);
            title('Среднеквадратичная ошибка оценивания','FontName','Courier','FontSize',14);
            xlabel('r','FontName','Courier'); ylabel('mse','FontName','Courier');
        </pre code>

        <h3>Результаты выполнения задания</h3>
        <ol>
            <li>Зависимость для среднеквадратичной ошибки оценивания плотности распределения 
            случайной величины по методу Парзена</li>
            <img src="plot1.png" alt="PLOT1">

            <li>Зависимость для среднеквадратичной ошибки оценивания плотности распределения 
                случайной величины по методу Парзена</li>
            <img src="plot2.png" alt="PLOT2">
        </ol>

        <h3>Выводы</h3>
        <ol>
            <li>На основе результатов имитационного моделирования алгоритмов оценивания 
                плотности по методу Парзена получены зависимости для среднеквадратичной ошибки 
                оценивания плотности распределения случайной величины от параметра оконной функции. 
                Зависимость имеет ярко выраженный минимум, который определяет оптимальное значение 
                параметра оконной функции для заданного вида плотности равное, примерно, 0.02-0.03.</li>

            <li>На основе результатов имитационного моделирования алгоритмов оценивания плотности 
                по методу Парзена получены зависимости для среднеквадратичной ошибки оценивания плотности 
                распределения случайной величины от величины r, определяющей значение параметра оконной 
                функции в соответствие с формулой h(r)=N^-r. Зависимость имеет ярко выраженный минимум, 
                который определяет оптимальное значение r для заданного вида плотности равное, примерно, 
                0.5-0.55.</li>
        </ol>

    </body>

</html>